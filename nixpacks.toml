[phases.setup]
nixPkgs = ['nodejs_20', 'pnpm']

[phases.install]
cmds = ['pnpm install --frozen-lockfile', 'pnpm add -D tsx']

[phases.build]
cmds = [
  'pwd',
  'ls -la',
  'ls -la server/ || echo "server dir not found"',
  'pnpm build:client',
  'mkdir -p dist/server-built',
  'cp -r server dist/server-built/',
  'ls -la dist/server-built/'
]

[start]
cmd = 'node start.mjs'
